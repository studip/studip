(self.webpackChunk_studip_core=self.webpackChunk_studip_core||[]).push([[950],{5393:function(e,t,r){"use strict";r.r(t),r.d(t,{Vue:function(){return o.Z},createApp:function(){return f},eventBus:function(){return m},store:function(){return h}});var a=r(9713),i=r.n(a),n=r(9100),s=r.n(n),o=r(538),l=r(7968),u=r.n(l);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p,m=new o.Z;o.Z.mixin({methods:{globalEmit:function(){m.emit.apply(m,arguments)},globalOn:function(){m.on.apply(m,arguments)}}}),o.Z,(p=r(8988)).keys().map((function(e){o.Z.component(e.split("/").pop().split(".")[0],p(e).default)})),o.Z.use(u());var h=new(u().Store)({});function f(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return s()(o.Z,[d({store:h},e)].concat(r))}},5606:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"blubber_globalstream"},[r("div",{directives:[{name:"scroll",rawName:"v-scroll"}],staticClass:"scrollable_area"},[r("blubber-public-composer"),e._v(" "),r("ol",{staticClass:"postings",attrs:{"aria-live":"polite"}},[e.stream_data.more_up?r("li",{staticClass:"more"},[r("studip-asset-img",{attrs:{file:"ajax-indicator-black.svg",width:"20"}})],1):e._e(),e._v(" "),e._l(e.sortedPostings,(function(t){return r("li",{key:t.thread_id,class:t.class,attrs:{"data-thread_id":t.thread_id}},[t.html?r("div",{staticClass:"thread_posting"},[r("div",{staticClass:"contextinfo"},[r("studip-date-time",{attrs:{timestamp:t.mkdate,relative:!0}}),e._v(" "),r("div",[e._v(e._s(t.user_name))]),e._v(" "),r("div",{staticClass:"avatar",style:{backgroundImage:"url("+t.avatar+")"}})],1),e._v(" "),r("div",{staticClass:"content",domProps:{innerHTML:e._s(t.html)}}),e._v(" "),r("a",{staticClass:"link_to_comments",attrs:{href:e.link(t.thread_id)},domProps:{innerHTML:e._s("Zur Diskussion".toLocaleString())},on:{click:function(t){return t.preventDefault(),e.changeActiveThread(t)}}})]):e._e()])})),e._v(" "),e.more_down?r("li",{staticClass:"more"},[r("studip-asset-img",{attrs:{file:"ajax-indicator-black.svg",width:"20"}})],1):e._e()],2)],1)])};a._withStripped=!0;var i={name:"blubber-globalstream",data:function(){return{already_loading_down:0}},props:["stream_data","more_down"],methods:{changeActiveThread:function(e){var t=$(e.target).closest("li");this.$root.changeActiveThread(t.data("thread_id"))},link:function(e){return STUDIP.URLHelper.getURL("dispatch.php/blubber/index/".concat(e))},addPosting:function(e){var t=this,r=!1;for(var a in this.stream_data)if(this.stream_data[a].thread_id===e.thread_id)return void(r=!0);r||(e.class=e.class+" new",this.stream_data.push(e),this.$nextTick((function(){STUDIP.Markup.element($(t.$el).find('.postings > li[data-thread_id="'.concat(e.thread_id,'"]')))})))}},mounted:function(){this.$nextTick((function(){$(this.$el).find(".postings .content").each((function(){STUDIP.Markup.element(this)}))}))},computed:{sortedPostings:function(){return this.stream_data.sort((function(e,t){return t.mkdate-e.mkdate}))}},directives:{scroll:{inserted:function(e){var t=$(e).closest(".blubber_globalstream")[0].__vue__;$(e).on("scroll",(function(r){var a=$(e).scrollTop();$(e).find(".postings").height();if($(e).toggleClass("scrolled",a>0),t.more_down&&a>$(e).find(".postings").height()-1e3&&!t.already_loading_down){t.already_loading_down=1;var i=null;for(var n in t.stream_data)(null===i||t.stream_data[n].mkdate<i)&&(i=t.stream_data[n].mkdate);$.ajax({url:STUDIP.ABSOLUTE_URI_STUDIP+"api.php/blubber/threads/global",type:"get",dataType:"json",data:{modifier:"olderthan",timestamp:i,limit:30},success:function(e){for(var r in e.postings)t.addPosting(e.postings[r]);t.more_down=e.more_down},complete:function(){t.already_loading_down=0}})}}))}}}},n=(0,r(1900).Z)(i,a,[],!1,null,null,null);n.options.__file="resources/vue/components/BlubberGlobalstream.vue";var s=n.exports},6609:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"writer"},[r("studip-icon",{attrs:{shape:"blubber",size:"30",role:"info"}}),e._v(" "),r("textarea",{attrs:{placeholder:"Schreib was, frag was. Enter zum Abschicken.".toLocaleString()},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.submit(t)},e.saveCommentToSession],change:e.saveCommentToSession}}),e._v(" "),r("label",{staticClass:"upload",attrs:{title:"Datei hochladen".toLocaleString()}},[r("input",{staticStyle:{display:"none"},attrs:{type:"file",multiple:""},on:{change:e.upload}}),e._v(" "),r("studip-icon",{attrs:{shape:"upload",size:"30"}})],1)],1)};a._withStripped=!0;var i={name:"blubber-public-composer",methods:{submit:function(e){var t=this;if(e&&"string"==typeof e||(e=$(this.$el).find("textarea").val(),$(this.$el).find("textarea").val(""),sessionStorage.removeItem("BlubberMemory-Writer-Public")),!e.trim())return!1;STUDIP.api.POST("blubber/threads",{data:{content:e}}).done((function(e){t.$parent.addPosting(e.thread_posting)}))},saveCommentToSession:function(e){var t=e.target.value;sessionStorage.setItem("BlubberMemory-Writer-Public",t)},upload:function(e){var t=void 0!==e.dataTransfer?e.dataTransfer.files:e.target.files,r=this,a=new FormData;for(var i in t)t[i].size>0&&a.append("file_".concat(i),t[i],t[i].name.normalize());var n=new XMLHttpRequest;n.open("POST","".concat(STUDIP.ABSOLUTE_URI_STUDIP,"dispatch.php/blubber/upload_files")),n.upload.addEventListener("progress",(function(e){var t=0,a=e.loaded||e.position,i=e.total;e.lengthComputable&&(t=Math.ceil(a/i*100)),$(r.$el).css("background-size","".concat(t,"% 100%"))})),n.addEventListener("load",(function(e){var t=JSON.parse(this.response);$(r.$el).find("textarea").val($(r.$el).find("textarea").val()+" "+t.inserts.join(" "))})),n.addEventListener("loadend",(function(e){$(r.$el).css("background-size","0% 100%")})),n.send(a)}},mounted:function(){this.$nextTick((function(){$(this.$el).find("textarea").autoResize({animateDuration:0,extraSpace:1});var e=sessionStorage.getItem("BlubberMemory-Writer-Public");e&&$(this.$el).find("textarea").val(e)}))}},n=(0,r(1900).Z)(i,a,[],!1,null,null,null);n.options.__file="resources/vue/components/BlubberPublicComposer.vue";var s=n.exports},9221:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"scroll",rawName:"v-scroll"}],staticClass:"scrollable_area blubber_thread_widget"},[r("transition-group",{attrs:{name:"blubberthreadwidget-list",tag:"ol"}},[e._l(e.sortedThreads,(function(t){return r("li",{key:t.thread_id,class:(e.active_thread===t.thread_id?"active":"")+(t.unseen_comments>0?" unseen":""),attrs:{"data-thread_id":t.thread_id,"data-unseen_comments":t.unseen_comments},on:{click:function(t){return t.preventDefault(),e.changeActiveThread(t)}}},[r("a",{attrs:{href:e.link(t.thread_id)}},[r("div",{staticClass:"avatar",style:{backgroundImage:"url("+t.avatar+")"}}),e._v(" "),r("div",{staticClass:"info"},[r("div",{staticClass:"name"},[e._v("\n                            "+e._s(t.name)+"\n                        ")]),e._v(" "),r("studip-date-time",{attrs:{timestamp:t.timestamp,relative:!0}})],1)])])})),e._v(" "),e.display_more_down?r("li",{key:"more",staticClass:"more"},[r("studip-asset-img",{attrs:{file:"ajax-indicator-black.svg",width:"20"}})],1):e._e()],2)],1)};a._withStripped=!0;var i={name:"blubber-thread-widget",props:["threads","active_thread","more_down"],data:function(){return{display_more_down:this.more_down,already_loading_down:0}},methods:{changeActiveThread:function(e){var t=$(e.target).closest("li");t.hasClass("active")||(t.siblings(".active").removeClass("active"),t.addClass("active"),this.$root.changeActiveThread(t.data("thread_id")))},link:function(e){return STUDIP.URLHelper.getURL("dispatch.php/blubber/index/".concat(e))},addThread:function(e){-1===this.threads.map((function(e){return e.thread_id})).indexOf(e.thread_id)&&this.threads.push(e)}},directives:{scroll:{inserted:function(e){var t=e.__vue__;$(e).parent().on("scroll",(function(r){var a=$(e).parent().scrollTop(),i=$(e).height();if($(e).toggleClass("scrolled",a>0),!(!t.display_more_down||a<=i-1e3||t.already_loading_down)){t.already_loading_down=!0;var n=t.threads.reduce((function(e,t){return"global"===t.thread_id?e:null===e?t.timestamp:Math.min(e,t.timestamp)}),null);STUDIP.api.GET("blubber/threads",{data:{modifier:"olderthan",timestamp:n,limit:50}}).done((function(e){e.threads.forEach((function(e){return t.addThread(e)})),t.display_more_down=e.more_down})).always((function(){t.already_loading_down=!1}))}}))}}},mounted:function(){},computed:{sortedThreads:function(){return this.threads.sort((function(e,t){return t.timestamp-e.timestamp}))}}},n=(0,r(1900).Z)(i,a,[],!1,null,null,null);n.options.__file="resources/vue/components/BlubberThreadWidget.vue";var s=n.exports},9967:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var a=function(){var e=this,t=e.$createElement;return(e._self._c||t)("img",{attrs:{src:e.url,width:e.width}})};a._withStripped=!0;var i={name:"studip-asset-img",props:["width","file"],computed:{url:function(){return"".concat(STUDIP.ASSETS_URL,"images/").concat(this.file)}}},n=(0,r(1900).Z)(i,a,[],!1,null,null,null);n.options.__file="resources/vue/components/StudipAssetImg.vue";var s=n.exports},6836:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return 0!=e.timestamp?r("time",{attrs:{datetime:e.datetime,title:e.title}},[e._v("\n    "+e._s(e.formatted_date())+"\n")]):e._e()};function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"00000000".concat(e).substr(-t)}a._withStripped=!0;var n={name:"studip-date-time",props:{timestamp:Number,relative:{type:Boolean,required:!1,default:!1}},computed:{datetime:function(){return Number.isInteger(this.timestamp)?new Date(1e3*this.timestamp).toISOString():""},title:function(){return!!this.display_relative()&&this.formatted_date(!0)}},methods:{display_relative:function(){return Date.now()-1e3*this.timestamp<432e5},formatted_date:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!Number.isInteger(this.timestamp))return"Should be integer: ".concat(this.timestamp);var t=new Date(1e3*this.timestamp),r=Date.now();return!e&&this.relative&&this.display_relative()?r-t<6e4?"Jetzt".toLocaleString():r-t<72e5?"Vor %s Minuten".toLocaleString().replace("%s",Math.floor((r-t)/6e4)):i(t.getHours())+":"+i(t.getMinutes()):i(t.getDate())+"."+i(t.getMonth()+1)+"."+t.getFullYear()+" "+i(t.getHours())+":"+i(t.getMinutes())}},mounted:function(){var e=this;window.setInterval((function(){e.$forceUpdate()}),1e3)}},s=(0,r(1900).Z)(n,a,[],!1,null,null,null);s.options.__file="resources/vue/components/StudipDateTime.vue";var o=s.exports},7191:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var a=function(){var e=this,t=e.$createElement;return(e._self._c||t)("span",[e._v("\n    "+e._s(e.formatted_size)+"\n")])};a._withStripped=!0;var i={name:"studip-file-size",props:{size:Number},computed:{formatted_size:function(){return this.size<1024?this.size+" Byte":this.size<1048576?(this.size/1024).toFixed(1)+" KB":this.size<1073741824?(this.size/1024/1024).toFixed(1)+" MB":this.size<1099511627776?(this.size/1024/1024/1024).toFixed(1)+" GB":this.size<0x4000000000000?(this.size/1024/1024/1024/1024).toFixed(1)+" TB":void 0}}},n=(0,r(1900).Z)(i,a,[],!1,null,null,null);n.options.__file="resources/vue/components/StudipFileSize.vue";var s=n.exports},5521:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.name?r("input",e._g(e._b({attrs:{type:"image",name:e.name,src:e.url,width:e.size,height:e.size}},"input",e.$attrs,!1),e.$listeners)):r("img",e._g(e._b({attrs:{src:e.url,width:e.size,height:e.size}},"img",e.$attrs,!1),e.$listeners))};a._withStripped=!0;var i={name:"studip-icon",props:{shape:String,role:{type:String,required:!1,default:"clickable"},size:{required:!1,default:16},name:{type:String,required:!1}},computed:{url:function(){return"".concat(STUDIP.ASSETS_URL,"images/icons/").concat(this.color,"/").concat(this.shape,".svg")},color:function(){switch(this.role){case"info":return"black";case"inactive":return"grey";case"accept":case"status-green":return"green";case"attention":case"new":case"status-red":return"red";case"info_alt":return"white";case"sort":case"status-yellow":return"yellow";case"lightblue":return"lightblue";case"clickable":case"navigation":default:return"blue"}}}},n=(0,r(1900).Z)(i,a,[],!1,null,null,null);n.options.__file="resources/vue/components/StudipIcon.vue";var s=n.exports},8988:function(e,t,r){var a={"./BlubberGlobalstream.vue":5606,"./BlubberPublicComposer.vue":6609,"./BlubberThread.vue":7792,"./BlubberThreadWidget.vue":9221,"./FilesTable.vue":2721,"./StudipAssetImg.vue":9967,"./StudipDateTime.vue":6836,"./StudipFileSize.vue":7191,"./StudipIcon.vue":5521};function i(e){var t=n(e);return r(t)}function n(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=n,e.exports=i,i.id=8988}}]);
//# sourceMappingURL=950.chunk.js.map