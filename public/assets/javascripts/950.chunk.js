(self.webpackChunk_studip_core=self.webpackChunk_studip_core||[]).push([[950],{5393:function(t,e,a){"use strict";a.r(e),a.d(e,{Vue:function(){return s.Z},createApp:function(){return l},eventBus:function(){return o}});var i,r=a(9100),n=a.n(r),s=a(538),o=new s.Z;function l(){for(var t=arguments.length,e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];return n()(s.Z,e)}s.Z.mixin({methods:{globalEmit:function(){o.emit.apply(o,arguments)},globalOn:function(){o.on.apply(o,arguments)}}}),s.Z,(i=a(6511)).keys().map((function(t){s.Z.component(t.split("/").pop().split(".")[0],i(t).default)}))},5606:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return s}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"blubber_globalstream"},[a("div",{directives:[{name:"scroll",rawName:"v-scroll"}],staticClass:"scrollable_area"},[a("blubber-public-composer"),t._v(" "),a("ol",{staticClass:"postings",attrs:{"aria-live":"polite"}},[t.stream_data.more_up?a("li",{staticClass:"more"},[a("studip-asset-img",{attrs:{file:"ajax-indicator-black.svg",width:"20"}})],1):t._e(),t._v(" "),t._l(t.sortedPostings,(function(e){return a("li",{key:e.thread_id,class:e.class,attrs:{"data-thread_id":e.thread_id}},[e.html?a("div",{staticClass:"thread_posting"},[a("div",{staticClass:"contextinfo"},[a("studip-date-time",{attrs:{timestamp:e.mkdate,relative:!0}}),t._v(" "),a("div",[t._v(t._s(e.user_name))]),t._v(" "),a("div",{staticClass:"avatar",style:{backgroundImage:"url("+e.avatar+")"}})],1),t._v(" "),a("div",{staticClass:"content",domProps:{innerHTML:t._s(e.html)}}),t._v(" "),a("a",{staticClass:"link_to_comments",attrs:{href:t.link(e.thread_id)},domProps:{innerHTML:t._s("Zur Diskussion".toLocaleString())},on:{click:function(e){return e.preventDefault(),t.changeActiveThread(e)}}})]):t._e()])})),t._v(" "),t.more_down?a("li",{staticClass:"more"},[a("studip-asset-img",{attrs:{file:"ajax-indicator-black.svg",width:"20"}})],1):t._e()],2)],1)])};i._withStripped=!0;var r={name:"blubber-globalstream",data:function(){return{already_loading_down:0}},props:["stream_data","more_down"],methods:{changeActiveThread:function(t){var e=$(t.target).closest("li");this.$root.changeActiveThread(e.data("thread_id"))},link:function(t){return STUDIP.URLHelper.getURL("dispatch.php/blubber/index/".concat(t))},addPosting:function(t){var e=this,a=!1;for(var i in this.stream_data)if(this.stream_data[i].thread_id===t.thread_id)return void(a=!0);a||(t.class=t.class+" new",this.stream_data.push(t),this.$nextTick((function(){STUDIP.Markup.element($(e.$el).find('.postings > li[data-thread_id="'.concat(t.thread_id,'"]')))})))}},mounted:function(){this.$nextTick((function(){$(this.$el).find(".postings .content").each((function(){STUDIP.Markup.element(this)}))}))},computed:{sortedPostings:function(){return this.stream_data.sort((function(t,e){return e.mkdate-t.mkdate}))}},directives:{scroll:{inserted:function(t){var e=$(t).closest(".blubber_globalstream")[0].__vue__;$(t).on("scroll",(function(a){var i=$(t).scrollTop();$(t).find(".postings").height();if($(t).toggleClass("scrolled",i>0),e.more_down&&i>$(t).find(".postings").height()-1e3&&!e.already_loading_down){e.already_loading_down=1;var r=null;for(var n in e.stream_data)(null===r||e.stream_data[n].mkdate<r)&&(r=e.stream_data[n].mkdate);$.ajax({url:STUDIP.ABSOLUTE_URI_STUDIP+"api.php/blubber/threads/global",type:"get",dataType:"json",data:{modifier:"olderthan",timestamp:r,limit:30},success:function(t){for(var a in t.postings)e.addPosting(t.postings[a]);e.more_down=t.more_down},complete:function(){e.already_loading_down=0}})}}))}}}},n=(0,a(1900).Z)(r,i,[],!1,null,null,null);n.options.__file="resources/vue/components/BlubberGlobalstream.vue";var s=n.exports},6609:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return s}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"writer"},[a("studip-icon",{attrs:{shape:"blubber",size:"30",role:"info"}}),t._v(" "),a("textarea",{attrs:{placeholder:"Schreib was, frag was. Enter zum Abschicken.".toLocaleString()},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:t.submit(e)},t.saveCommentToSession],change:t.saveCommentToSession}}),t._v(" "),a("label",{staticClass:"upload",attrs:{title:"Datei hochladen".toLocaleString()}},[a("input",{staticStyle:{display:"none"},attrs:{type:"file",multiple:""},on:{change:t.upload}}),t._v(" "),a("studip-icon",{attrs:{shape:"upload",size:"30"}})],1)],1)};i._withStripped=!0;var r={name:"blubber-public-composer",methods:{submit:function(t){var e=this;if(t&&"string"==typeof t||(t=$(this.$el).find("textarea").val(),$(this.$el).find("textarea").val(""),sessionStorage.removeItem("BlubberMemory-Writer-Public")),!t.trim())return!1;STUDIP.api.POST("blubber/threads",{data:{content:t}}).done((function(t){e.$parent.addPosting(t.thread_posting)}))},saveCommentToSession:function(t){var e=t.target.value;sessionStorage.setItem("BlubberMemory-Writer-Public",e)},upload:function(t){var e=void 0!==t.dataTransfer?t.dataTransfer.files:t.target.files,a=this,i=new FormData;for(var r in e)e[r].size>0&&i.append("file_".concat(r),e[r],e[r].name.normalize());var n=new XMLHttpRequest;n.open("POST","".concat(STUDIP.ABSOLUTE_URI_STUDIP,"dispatch.php/blubber/upload_files")),n.upload.addEventListener("progress",(function(t){var e=0,i=t.loaded||t.position,r=t.total;t.lengthComputable&&(e=Math.ceil(i/r*100)),$(a.$el).css("background-size","".concat(e,"% 100%"))})),n.addEventListener("load",(function(t){var e=JSON.parse(this.response);$(a.$el).find("textarea").val($(a.$el).find("textarea").val()+" "+e.inserts.join(" "))})),n.addEventListener("loadend",(function(t){$(a.$el).css("background-size","0% 100%")})),n.send(i)}},mounted:function(){this.$nextTick((function(){$(this.$el).find("textarea").autoResize({animateDuration:0,extraSpace:1});var t=sessionStorage.getItem("BlubberMemory-Writer-Public");t&&$(this.$el).find("textarea").val(t)}))}},n=(0,a(1900).Z)(r,i,[],!1,null,null,null);n.options.__file="resources/vue/components/BlubberPublicComposer.vue";var s=n.exports},9221:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return s}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"scroll",rawName:"v-scroll"}],staticClass:"scrollable_area blubber_thread_widget"},[a("transition-group",{attrs:{name:"blubberthreadwidget-list",tag:"ol"}},[t._l(t.sortedThreads,(function(e){return a("li",{key:e.thread_id,class:(t.active_thread===e.thread_id?"active":"")+(e.unseen_comments>0?" unseen":""),attrs:{"data-thread_id":e.thread_id,"data-unseen_comments":e.unseen_comments},on:{click:function(e){return e.preventDefault(),t.changeActiveThread(e)}}},[a("a",{attrs:{href:t.link(e.thread_id)}},[a("div",{staticClass:"avatar",style:{backgroundImage:"url("+e.avatar+")"}}),t._v(" "),a("div",{staticClass:"info"},[a("div",{staticClass:"name"},[t._v("\n                            "+t._s(e.name)+"\n                        ")]),t._v(" "),a("studip-date-time",{attrs:{timestamp:e.timestamp,relative:!0}})],1)])])})),t._v(" "),t.display_more_down?a("li",{key:"more",staticClass:"more"},[a("studip-asset-img",{attrs:{file:"ajax-indicator-black.svg",width:"20"}})],1):t._e()],2)],1)};i._withStripped=!0;var r={name:"blubber-thread-widget",props:["threads","active_thread","more_down"],data:function(){return{display_more_down:this.more_down,already_loading_down:0}},methods:{changeActiveThread:function(t){var e=$(t.target).closest("li");e.hasClass("active")||(e.siblings(".active").removeClass("active"),e.addClass("active"),this.$root.changeActiveThread(e.data("thread_id")))},link:function(t){return STUDIP.URLHelper.getURL("dispatch.php/blubber/index/".concat(t))},addThread:function(t){-1===this.threads.map((function(t){return t.thread_id})).indexOf(t.thread_id)&&this.threads.push(t)}},directives:{scroll:{inserted:function(t){var e=t.__vue__;$(t).parent().on("scroll",(function(a){var i=$(t).parent().scrollTop(),r=$(t).height();if($(t).toggleClass("scrolled",i>0),!(!e.display_more_down||i<=r-1e3||e.already_loading_down)){e.already_loading_down=!0;var n=e.threads.reduce((function(t,e){return"global"===e.thread_id?t:null===t?e.timestamp:Math.min(t,e.timestamp)}),null);STUDIP.api.GET("blubber/threads",{data:{modifier:"olderthan",timestamp:n,limit:50}}).done((function(t){t.threads.forEach((function(t){return e.addThread(t)})),e.display_more_down=t.more_down})).always((function(){e.already_loading_down=!1}))}}))}}},mounted:function(){},computed:{sortedThreads:function(){return this.threads.sort((function(t,e){return e.timestamp-t.timestamp}))}}},n=(0,a(1900).Z)(r,i,[],!1,null,null,null);n.options.__file="resources/vue/components/BlubberThreadWidget.vue";var s=n.exports},9967:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return s}});var i=function(){var t=this,e=t.$createElement;return(t._self._c||e)("img",{attrs:{src:t.url,width:t.width}})};i._withStripped=!0;var r={name:"studip-asset-img",props:["width","file"],computed:{url:function(){return"".concat(STUDIP.ASSETS_URL,"images/").concat(this.file)}}},n=(0,a(1900).Z)(r,i,[],!1,null,null,null);n.options.__file="resources/vue/components/StudipAssetImg.vue";var s=n.exports},6836:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return o}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return 0!=t.timestamp?a("time",{attrs:{datetime:t.datetime,title:t.title}},[t._v("\n    "+t._s(t.formatted_date())+"\n")]):t._e()};function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"00000000".concat(t).substr(-e)}i._withStripped=!0;var n={name:"studip-date-time",props:{timestamp:Number,relative:{type:Boolean,required:!1,default:!1}},computed:{datetime:function(){return Number.isInteger(this.timestamp)?new Date(1e3*this.timestamp).toISOString():""},title:function(){return!!this.display_relative()&&this.formatted_date(!0)}},methods:{display_relative:function(){return Date.now()-1e3*this.timestamp<432e5},formatted_date:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!Number.isInteger(this.timestamp))return"Should be integer: ".concat(this.timestamp);var e=new Date(1e3*this.timestamp),a=Date.now();return!t&&this.relative&&this.display_relative()?a-e<6e4?"Jetzt".toLocaleString():a-e<72e5?"Vor %s Minuten".toLocaleString().replace("%s",Math.floor((a-e)/6e4)):r(e.getHours())+":"+r(e.getMinutes()):r(e.getDate())+"."+r(e.getMonth()+1)+"."+e.getFullYear()+" "+r(e.getHours())+":"+r(e.getMinutes())}},mounted:function(){var t=this;window.setInterval((function(){t.$forceUpdate()}),1e3)}},s=(0,a(1900).Z)(n,i,[],!1,null,null,null);s.options.__file="resources/vue/components/StudipDateTime.vue";var o=s.exports},7191:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return s}});var i=function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",[t._v("\n    "+t._s(t.formatted_size)+"\n")])};i._withStripped=!0;var r={name:"studip-file-size",props:{size:Number},computed:{formatted_size:function(){return this.size<1024?this.size+" Byte":this.size<1048576?(this.size/1024).toFixed(1)+" KB":this.size<1073741824?(this.size/1024/1024).toFixed(1)+" MB":this.size<1099511627776?(this.size/1024/1024/1024).toFixed(1)+" GB":this.size<0x4000000000000?(this.size/1024/1024/1024/1024).toFixed(1)+" TB":void 0}}},n=(0,a(1900).Z)(r,i,[],!1,null,null,null);n.options.__file="resources/vue/components/StudipFileSize.vue";var s=n.exports},5521:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return s}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.name?a("input",t._g(t._b({attrs:{type:"image",name:t.name,src:t.url,width:t.size,height:t.size}},"input",t.$attrs,!1),t.$listeners)):a("img",t._g(t._b({attrs:{src:t.url,width:t.size,height:t.size}},"img",t.$attrs,!1),t.$listeners))};i._withStripped=!0;var r={name:"studip-icon",props:{shape:String,role:{type:String,required:!1,default:"clickable"},size:{required:!1,default:16},name:{type:String,required:!1}},computed:{url:function(){return"".concat(STUDIP.ASSETS_URL,"images/icons/").concat(this.color,"/").concat(this.shape,".svg")},color:function(){switch(this.role){case"info":return"black";case"inactive":return"grey";case"accept":case"status-green":return"green";case"attention":case"new":case"status-red":return"red";case"info_alt":return"white";case"sort":case"status-yellow":return"yellow";case"lightblue":return"lightblue";case"clickable":case"navigation":default:return"blue"}}}},n=(0,a(1900).Z)(r,i,[],!1,null,null,null);n.options.__file="resources/vue/components/StudipIcon.vue";var s=n.exports},6511:function(t,e,a){var i={"./BlubberGlobalstream.vue":5606,"./BlubberPublicComposer.vue":6609,"./BlubberThread.vue":7792,"./BlubberThreadWidget.vue":9221,"./FilesTable.vue":2721,"./StudipAssetImg.vue":9967,"./StudipDateTime.vue":6836,"./StudipFileSize.vue":7191,"./StudipIcon.vue":5521};function r(t){var e=n(t);return a(e)}function n(t){if(!a.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=n,t.exports=r,r.id=6511}}]);
//# sourceMappingURL=950.chunk.js.map