{"version":3,"sources":["webpack://@studip/core/./resources/assets/javascripts/bootstrap/installer.js","webpack://@studip/core/webpack/bootstrap","webpack://@studip/core/webpack/runtime/compat get default export","webpack://@studip/core/webpack/runtime/define property getters","webpack://@studip/core/webpack/runtime/hasOwnProperty shorthand"],"names":["fn","window","hidden_input","document","createElement","setAttribute","querySelector","append","requests","querySelectorAll","forEach","element","push","url","dataset","requestUrl","event_source","undefined","eventSource","next","length","promise","current","shift","classList","add","notifier","Promise","resolve","reject","progress","nextElementSibling","total","insertAdjacentElement","offsetLeft","offsetTop","evtSource","EventSource","withCredentials","addEventListener","event","parseInt","data","toFixed","close","finally","parentNode","removeChild","remove","fetch","cache","credentials","then","response","ok","json","message","catch","error","Object","key","value","innerText","readyState","setTimeout","__webpack_module_cache__","__webpack_require__","moduleId","exports","module","__webpack_modules__","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call"],"mappings":"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","file":"javascripts/studip-installer.js","sourcesContent":["/*jslint esversion: 6*/\n\nfunction domReady(fn) {\n    if (document.readyState === 'complete' || document.readyState === 'interactive') {\n        setTimeout(fn, 1);\n    } else {\n        document.addEventListener('DOMContentLoaded', fn);\n    }\n}\n\ndomReady(() => {\n    if (!('fetch' in window) || !('Promise' in window)) {\n        const hidden_input = document.createElement('input');\n        hidden_input.setAttribute('type', 'hidden');\n        hidden_input.setAttribute('name', 'basic');\n        hidden_input.setAttribute('value', 1);\n        document.querySelector('form').append(hidden_input);\n\n        return;\n    }\n\n    var requests = [];\n    document.querySelectorAll('dl.requests > dt[data-request-url]').forEach((element) => {\n        requests.push({\n            element: element,\n            url: element.dataset.requestUrl,\n            event_source: element.dataset.eventSource !== undefined\n        });\n    });\n\n    function next() {\n        if (requests.length === 0) {\n            return;\n        }\n        const current = requests.shift();\n        var promise;\n\n        current.element.classList.add('requesting');\n\n        if (current.event_source && 'EventSource' in window) {\n            const notifier = document.createElement('div');\n            notifier.setAttribute('data-percent', 0);\n\n            promise = new Promise((resolve, reject) => {\n                current.element.classList.add('event-sourced');\n\n                const progress = current.element.nextElementSibling.nextElementSibling.nextElementSibling;\n                var total = 0;\n\n                progress.insertAdjacentElement('afterend', notifier);\n                notifier.setAttribute(\n                    'style',\n                    `left: ${progress.offsetLeft}px; top: ${progress.offsetTop}px`\n                );\n\n                const evtSource = new EventSource(current.url + '?evts=1', {\n                    withCredentials: true\n                });\n                evtSource.addEventListener('total', (event) => {\n                    total = parseInt(event.data, 10);\n                    progress.setAttribute('max', total);\n                });\n                evtSource.addEventListener('file', (event) => {\n                    notifier.setAttribute('data-file', event.data);\n                });\n                evtSource.addEventListener('current', (event) => {\n                    let current = parseInt(event.data, 10);\n                    progress.setAttribute('value', current);\n                    notifier.setAttribute('data-percent', (100 * current / total).toFixed(2));\n                });\n                evtSource.addEventListener('error', (event) => {\n                    evtSource.close();\n                    reject(event.data || 'Fehler beim Installieren');\n                });\n                evtSource.addEventListener('close', (event) => {\n                    evtSource.close();\n                    resolve();\n                });\n            });\n\n            promise.finally(() => {\n                if (notifier.parentNode) {\n                    notifier.parentNode.removeChild(notifier);\n                }\n                current.element.classList.remove('event-sourced');\n            });\n        } else {\n            promise = fetch(current.url, {\n                cache: 'no-cache',\n                credentials: 'same-origin'\n            }).then(response => {\n                if (!response.ok) {\n                    return response.json().then(message => {\n                        return Promise.reject(message);\n                    });\n                }\n            });\n        }\n\n        promise.then(response => {\n            current.element.classList.add('succeeded');\n            next();\n        }).catch(error => {\n            current.element.classList.add('failed');\n\n            if (error !== null && error === Object(error)) {\n                current.element.nextElementSibling.nextElementSibling.querySelectorAll('.response').forEach((element) => {\n                    let key = element.dataset.key;\n                    element.value = error[key];\n                });\n            } else {\n                current.element.nextElementSibling.nextElementSibling.querySelector('.response').innerText = error;\n            }\n        }).finally(() => {\n            current.element.classList.remove('requesting');\n        });\n    }\n\n    next();\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }"],"sourceRoot":""}