(self.webpackChunk_studip_core=self.webpackChunk_studip_core||[]).push([[606,900,758],{5606:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return r}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"blubber_globalstream"},[a("div",{directives:[{name:"scroll",rawName:"v-scroll"}],staticClass:"scrollable_area"},[a("blubber-public-composer"),t._v(" "),a("ol",{staticClass:"postings",attrs:{"aria-live":"polite"}},[t.stream_data.more_up?a("li",{staticClass:"more"},[a("studip-asset-img",{attrs:{file:"ajax-indicator-black.svg",width:"20"}})],1):t._e(),t._v(" "),t._l(t.sortedPostings,(function(e){return a("li",{key:e.thread_id,class:e.class,attrs:{"data-thread_id":e.thread_id}},[e.html?a("div",{staticClass:"thread_posting"},[a("div",{staticClass:"contextinfo"},[a("studip-date-time",{attrs:{timestamp:e.mkdate,relative:!0}}),t._v(" "),a("div",[t._v(t._s(e.user_name))]),t._v(" "),a("div",{staticClass:"avatar",style:{backgroundImage:"url("+e.avatar+")"}})],1),t._v(" "),a("div",{staticClass:"content",domProps:{innerHTML:t._s(e.html)}}),t._v(" "),a("a",{staticClass:"link_to_comments",attrs:{href:t.link(e.thread_id)},domProps:{innerHTML:t._s("Zur Diskussion".toLocaleString())},on:{click:function(e){return e.preventDefault(),t.changeActiveThread(e)}}})]):t._e()])})),t._v(" "),t.more_down?a("li",{staticClass:"more"},[a("studip-asset-img",{attrs:{file:"ajax-indicator-black.svg",width:"20"}})],1):t._e()],2)],1)])};s._withStripped=!0;var n={name:"blubber-globalstream",data:function(){return{already_loading_down:0}},props:["stream_data","more_down"],methods:{changeActiveThread:function(t){var e=$(t.target).closest("li");this.$root.changeActiveThread(e.data("thread_id"))},link:function(t){return STUDIP.URLHelper.getURL("dispatch.php/blubber/index/".concat(t))},addPosting:function(t){var e=this,a=!1;for(var s in this.stream_data)if(this.stream_data[s].thread_id===t.thread_id)return void(a=!0);a||(t.class=t.class+" new",this.stream_data.push(t),this.$nextTick((function(){STUDIP.Markup.element($(e.$el).find('.postings > li[data-thread_id="'.concat(t.thread_id,'"]')))})))}},mounted:function(){this.$nextTick((function(){$(this.$el).find(".postings .content").each((function(){STUDIP.Markup.element(this)}))}))},computed:{sortedPostings:function(){return this.stream_data.sort((function(t,e){return e.mkdate-t.mkdate}))}},directives:{scroll:{inserted:function(t){var e=$(t).closest(".blubber_globalstream")[0].__vue__;$(t).on("scroll",(function(a){var s=$(t).scrollTop();$(t).find(".postings").height();if($(t).toggleClass("scrolled",s>0),e.more_down&&s>$(t).find(".postings").height()-1e3&&!e.already_loading_down){e.already_loading_down=1;var n=null;for(var i in e.stream_data)(null===n||e.stream_data[i].mkdate<n)&&(n=e.stream_data[i].mkdate);$.ajax({url:STUDIP.ABSOLUTE_URI_STUDIP+"api.php/blubber/threads/global",type:"get",dataType:"json",data:{modifier:"olderthan",timestamp:n,limit:30},success:function(t){for(var a in t.postings)e.addPosting(t.postings[a]);e.more_down=t.more_down},complete:function(){e.already_loading_down=0}})}}))}}}},i=(0,a(1900).Z)(n,s,[],!1,null,null,null);i.options.__file="resources/vue/components/BlubberGlobalstream.vue";var r=i.exports},1900:function(t,e,a){"use strict";function s(t,e,a,s,n,i,r,o){var d,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=a,l._compiled=!0),s&&(l.functional=!0),i&&(l._scopeId="data-v-"+i),r?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},l._ssrRegister=d):n&&(d=o?function(){n.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:n),d)if(l.functional){l._injectStyles=d;var c=l.render;l.render=function(t,e){return d.call(e),c(t,e)}}else{var _=l.beforeCreate;l.beforeCreate=_?[].concat(_,d):[d]}return{exports:t,options:l}}a.d(e,{Z:function(){return s}})}}]);
//# sourceMappingURL=606.chunk.js.map